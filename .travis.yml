sudo: required

language: ruby

rvm:
  - 2.3.1

cache: bundler

cache:
  directories:
  - vendor/bundle

services:
  - docker

env:
  global:
    - secure: "fjYxh90ocihcpn5fdGncENizjxBBuuJJ+e4Nqho4viNvl195pm26s2rEjfoOXvYQ/GJ0F2qLzpkZ3+DMZpIwTXVB9HbgssM1Z7tKr673mm3KIzxWECjP/5El5jk07IGfxN7cN5a/yI5ICGjdoYO8WkgOjSFVPI26f1XvMh13g0KSWQGrL/GrF1C3ePuKiUJarLF51MyUyLh8gWOivGItHikTZ7nhQeMLM+H+fCKg2jKS77Fl/5cgKkQTmBviOucp9JF0qmepvCBUvw5Tmw2MsqVLBI4GIzDb795O6atRQZFo16OVn4pKSmcWgMJVANF8/prycXoRh+iPZpYHwCWUViLD7WVF3g8Z73r0ChQOP75lUALSY7h4/TFGmqGm3kGGPT9AE1HcEcN+t+59g0QeoN0sTY1D6JeaptS9p42b8ykUNO+c/BnqxQHjg8CtJm0ASkH5SpEn7s7M2dUOvT2KQuFWsYYlQPQuWbI27+h41YeTxJSOZItlUFLKW8wrBJ+Xj+wqfs24AUrBgZjtrROoyL3ULzkirn0DU2hsB6bLLcFbhbRlgEXk5aiKpYR/kj1Nv2LqlK8pReW1xeOR/3X7kaRAy2913Epu+4UGoNz8SH+m4+9QPYGWqri5DSks7/jmAa1QZ2CM5bRIw/XYITRImC9y9pEOR0uDQLreylvr1+c="

before_install:
  - docker pull kontena/etcd:2.3.7
  - docker run -d --net host --name etcd kontena/etcd:2.3.7

script:
  - bundle install --path vendor/bundle
  - bundle exec rspec spec/

deploy:
  - provider: script
    script: "$TRAVIS_BUILD_DIR/build/travis/deploy.sh"
    on:
      tags: true
      rvm: 2.3.1
      repo: kontena/kontena-docker-ipam-plugin
